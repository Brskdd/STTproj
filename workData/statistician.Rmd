---
title: "Statistician"
author: "Heeryun Kim"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load}
library(dplyr)

load("SpeedDating.rda")
View(SpeedDating)
```

## Q1. Are men more likely to say yes to another date than women? 
## This is of interest because we are interested to see which gender is more likely to go on another date.
```{r Q1 clean}
speedDatingCleanedQ1 <- SpeedDating %>%
  filter(!is.na(DecisionM)) %>%
  filter(!is.na(DecisionF)) %>%
  select(DecisionM, DecisionF)
```
Hypothesis test.
```{r}
statistic = mean(speedDatingCleanedQ1$DecisionM)- mean(speedDatingCleanedQ1$DecisionF)
statistic
```
The statistic suggest that males are more likely to say yes to a second date than females.
$$
H_0: \text{diff}_{(M - F)} = 0
\\
H_A:\text{diff}_{(M - F)} > 0
$$
```{r}
nullPopulation <- function(df){
  diff <- mean(sample(c(0,1), length(df$DecisionM), replace = TRUE)) -
          mean(sample(c(0,1), length(df$DecisionF), replace = TRUE))
  return(diff)
}
nullDistribution <- replicate(1000,nullPopulation(speedDatingCleanedQ1))

statistic = mean(speedDatingCleanedQ1$DecisionM)- mean(speedDatingCleanedQ1$DecisionF)
p_value <- mean(statistic <= nullDistribution )

print(p_value)
print(statistic)

hist(nullDistribution)
abline(v = statistic, col = 'red')
```
With a p-value of 0.052 we fail to reject the null hypothesis with a statistic of 0.068 difference between males 
and females saying yes to a second date. We do not have significant evidence that supports the alternative
hypothesis that males say yes to second dates more than females.


## Q2. Which score seems to be the most important for a man's Like score?
## This is of interest as there are lots of categories so which category is the most important to a man liking the woman.
```{r Q2 clean.a}
speedDatingCleanedQ2 <- na.omit(SpeedDating)
speedDatingCleanedQ2M <- speedDatingCleanedQ2 %>%
  select(DecisionM, LikeM, PartnerYesM, AttractiveM, SincereM, IntelligentM, FunM, AmbitiousM, SharedInterestsM)
   #omit AgeM, RaceM b/c they don't seem to have a relationship with like
```
Linear regression.
```{r}
pairs(speedDatingCleanedQ2[, c("LikeM", "PartnerYesM", "AgeM", "RaceM", "AttractiveM", "SincereM", "IntelligentM", "FunM", "AmbitiousM", "SharedInterestsM")])

```
There seems to be multicolinearity.
Age and race do not seem to have a relationship with like rating.

## Q2. Which score seems to be the most important for a woman's Like score?
## This is of interest as there are lots of categories so which category is the most 
important to a woman liking the man.
```{r Q2 clean.a}
speedDatingCleanedQ2 <- na.omit(SpeedDating)
speedDatingCleanedQ2F <- speedDatingCleanedQ2 %>%
  select(DecisionF, LikeF, PartnerYesF, AttractiveF, SincereF, IntelligentF, FunF, AmbitiousF, SharedInterestsF)
  #omit AgeF, RaceF b/c they don't seem to have a relationship with like
``` 
Linear regression.
```{r}
pairs(speedDatingCleanedQ2[, c("LikeF", "PartnerYesF", "AgeF", "RaceF", "AttractiveF", "SincereF", "IntelligentF", "FunF", "AmbitiousF", "SharedInterestsF")])
```
There seems to be multicolinearity.
Age and race do not seem to have a relationship with like rating.

## Q3. Do larger age gaps affect if either a man or a woman want another date?
## There are a lot of different age gaps in the data so we are curious if a certain age gap would 
correlate with either gender saying no to another date.
speedDatingCleanedQ4 <- SpeedDating %>%

#=======
## Q3. Do larger age gaps affect if either a man or a woman view each other as attractive?
## There are a lot of different age gaps in the data so we are curious if a certain age gap would 
correlate with either gender viewing the other as less attractive.
```{r Q3 clean}
speedDatingCleanedQ3 <- SpeedDating %>%
  filter(!is.na(AgeM)) %>%
  filter(!is.na(AgeF)) %>%
  filter(!is.na(AttractiveM)) %>%
  filter(!is.na(AttractiveF)) %>%
  mutate(ageDiff = AgeM-AgeF) %>%
  select(ageDiff, AttractiveM, AttractiveF)
```  
$$
H_0: \rho = 0 
\\
H_A: \rho < 0
$$

```{r}  
plot(speedDatingCleanedQ3$ageDiff, speedDatingCleanedQ3$AttractiveM )
cor(speedDatingCleanedQ3$ageDiff, speedDatingCleanedQ3$AttractiveM)
```
```{r}
shuffleCorrelationM <- function(df){
  shuffled_df<- df %>%
    mutate(shuffled_strenth = sample(ageDiff, length(ageDiff), replace=FALSE))
  return(cor(shuffled_df$shuffled_strenth, shuffled_df$AttractiveM))
}

nullDistributionM <- replicate(1000, shuffleCorrelationM(speedDatingCleanedQ3))

statisticM <-cor(speedDatingCleanedQ3$ageDiff, speedDatingCleanedQ3$AttractiveM)

p_valueM <- mean(statisticM <= nullDistributionM )
print(p_valueM)
print(statisticM)


hist(nullDistributionM, xlim = c(-0.2, 0.8))
abline(v = statisticM, col = 'red')
```
The p-value for age difference and male attractiveness rating is 0.143 for a corrolation static of 0.643. 
At an alpha level of 0.01, we fail to reject the null hypothesis. There is not 
significant evidence that supports that Age gaps and percieved attractiveness are corrolated for males.

```{r}
plot(speedDatingCleanedQ3$ageDiff, speedDatingCleanedQ3$AttractiveF )
cor(speedDatingCleanedQ3$ageDiff, speedDatingCleanedQ3$AttractiveF)


```


$$
H_0: \rho = 0 
\\
H_A: \rho < 0
$$
```{r }
shuffleCorrelationM <- function(df){
  shuffled_df<- df %>%
    mutate(shuffled_strenth = sample(ageDiff, length(ageDiff), replace=FALSE))
  return(cor(shuffled_df$shuffled_strenth, shuffled_df$AttractiveF))
}

nullDistributionF <- replicate(1000, shuffleCorrelationM(speedDatingCleanedQ3))

statisticF <-cor(speedDatingCleanedQ3$ageDiff, speedDatingCleanedQ3$AttractiveF)

p_valueF <- mean(statisticF >= nullDistributionF )
print(p_valueF)
print(statisticF)


hist(nullDistributionF, xlim = c(-0.2, 0.8))
abline(v = statisticF, col = 'red')
```
The p-value for age difference and female attractiveness rating is 0.145 for a corrolation static of -0.669. 
At an alpha level of 0.01, we fail to reject the null hypothesis. There is not 
significant evidence that supports that Age gaps and percieved attractiveness are corrolated for females.


#=======
##Q4. Do people find people they view as attractive to be more fun.
## We are curious about this as we want to know if one person finds another person attractive if that will influence their perspective on how fun the other person is to be around.

```{r Q4 clean}
speedDatingCleanedQ4 <- SpeedDating %>%
  filter(!is.na(AttractiveM)) %>%
  filter(!is.na(AttractiveF)) %>%
  filter(!is.na(FunM)) %>%
  filter(!is.na(FunF)) %>%
  select(AttractiveM, AttractiveF, FunM, FunF)

```
$$
H_0: \rho = 0 
\\
H_A: \rho < 0
$$
Check for linear relationship with scatter plot and corrolation
```{r}
plot(speedDatingCleanedQ4$AttractiveM, speedDatingCleanedQ4$FunM)
cor(speedDatingCleanedQ4$AttractiveM, speedDatingCleanedQ4$FunM)
```

Both scatterplots have a clear weak, positive, linear relationship between variables.
```{r}
shuffleCorrelationM <- function(df){
  shuffled_df<- df %>%
    mutate(shuffled_strenth = sample(AttractiveM, length(AttractiveM), replace=FALSE))
  return(cor(shuffled_df$shuffled_strenth, shuffled_df$FunM))
}

nullDistributionM <- replicate(1000, shuffleCorrelationM(speedDatingCleanedQ4))

statisticM <-cor(speedDatingCleanedQ4$AttractiveM, speedDatingCleanedQ4$FunM)

p_valueM <- mean(statisticM <= nullDistributionM )
print(p_valueM)
print(statisticM)


hist(nullDistributionM, xlim = c(-0.2, 0.8))
abline(v = statisticM, col = 'red')
```

```{r}

plot(speedDatingCleanedQ4$AttractiveF, speedDatingCleanedQ4$FunF)
cor(speedDatingCleanedQ4$AttractiveF, speedDatingCleanedQ4$FunF)
```

```{r}
shuffleCorrelationF <- function(df){
  shuffled_df<- df %>%
    mutate(shuffled_strenth = sample(AttractiveF, length(AttractiveF), replace=FALSE))
  return(cor(shuffled_df$shuffled_strenth, shuffled_df$FunF))
}

nullDistributionF <- replicate(1000, shuffleCorrelationF(speedDatingCleanedQ4))

statisticF <-cor(speedDatingCleanedQ4$AttractiveF, speedDatingCleanedQ4$FunF)

p_valueF <- mean(statisticF <= nullDistributionF )
print(p_valueF)
print(statisticF)

hist(nullDistributionF, xlim = c(-0.2, 0.6))
abline(v = statisticF, col = 'red')
```
The p-value for both corrolations is 0. We can reject the null hypothesis with 
a alpha level of 0.01 The statistics are significant, there is significant 
evidence that Attractiveness and Fund are corrolated for both men and women.

  - we can do a linear regression to predict Fun with Attractiveness
  - check assumptions.
  
